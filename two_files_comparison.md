# 两个独立 Excel 文件对比分析

## 文件信息

1. **22高二一调.xls**
2. **22高二期中.xls**

---

## 关键发现：结构完全不同！

### 文件1：22高二一调.xls

**工作表名称**: "高二一调"（只有1个工作表）

**表头结构**（前3行）:
```
行1: [空] | 姓名 | 语文 | 校次 | 数学 | 校次 | 英语 | 校次 | 物理 | 校次 | 化学 | 校次 | 生物 | 校次 | 总分 | 校次
行2: [空] | [空] | 得分 | 校次 | 得分 | 校次 | 得分 | 校次 | 得分 | 校次 | 得分 | 校次 | 得分 | 校次 | 得分 | 校次
行3: 高二一调 | 柴艺萱 | 97.5 | 873 | 115 | 197 | 127.5 | 30 | 92 | 7 | 81 | 215 | 84 | 132 | 597 | 68
```

**特征**:
- **双层表头**: 第1行是科目名，第2行是"得分/校次"标签
- **数据从第3行开始**
- **第1列**: 所有数据行都是"高二一调"
- **第2列**: 姓名
- **列3-16**: 各科得分和校次交替出现

---

### 文件2：22高二期中.xls

**工作表名称**: "高二期中"（只有1个工作表）

**表头结构**（前3行）:
```
行1: [空] | 姓名 | 语文 | [空] | 数学 | [空] | 英语 | [空] | 物理 | [空] | 化学 | [空] | 生物 | [空] | 总分 | 校次
行2: 高二期中 | 柴艺萱 | 111 | 402 | 135 | 563 | 132 | 94 | 64 | 463 | 100 | 1 | 79 | 281 | 624 | 189
行3: 高二期中 | 陈琪荣 | 116 | 123 | 150 | 1 | 129 | 151 | 81 | 117 | 92 | 143 | 78 | 319 | 646 | 85
```

**特征**:
- **单层表头**: 只有第1行是表头
- **没有"得分/校次"标签行**
- **数据从第2行开始**
- **第1列**: 所有数据行都是"高二期中"
- **第2列**: 姓名
- **列3-16**: 各科得分和校次交替，但校次列的列名为空

---

## 核心差异对比表

| 维度 | 22高二一调.xls | 22高二期中.xls |
|------|---------------|---------------|
| **表头行数** | 2行（双层） | 1行（单层） |
| **数据起始行** | 第3行 | 第2行 |
| **第2行内容** | "得分/校次"标签 | 学生数据 |
| **校次列列名** | 都有"校次"标签 | 列名为空 |
| **列3/5/7/9/11/13/15** | 有"得分"标签 | 直接是科目名 |
| **列名完整性** | 相对完整 | 多个空列名 |

---

## 数据内容对比

### 共同点:
1. **学生数量**: 都是54个学生（加上表头共56行）
2. **学生名单**: 完全相同（柴艺萱、陈琪荣、翟梓轩等）
3. **科目**: 语文、数学、英语、物理、化学、生物
4. **指标**: 每科都有得分和校次（校内排名）
5. **列数**: 都是16列
6. **第1列冗余**: 都重复写考试名称

### 样本数据对比（柴艺萱）:

**高二一调**:
- 语文: 97.5 (校次873)
- 数学: 115 (校次197)
- 英语: 127.5 (校次30)
- 总分: 597 (校次68)

**高二期中**:
- 语文: 111 (校次402)
- 数学: 135 (校次563)
- 英语: 132 (校次94)
- 总分: 624 (校次189)

---

## 问题总结

### 致命缺陷

**1. 表头结构不统一**
- 同一个项目的两个文件，表头完全不同
- 无法用同一套代码解析

**2. 列名缺失（22高二期中.xls）**
- 多个列名为空，必须靠位置推断
- 违反数据规范的基本原则

**3. 第1列完全冗余**
- 两个文件都重复记录考试名称
- 文件名已经标识清楚，纯属画蛇添足

**4. 混淆的表头**
- "得分/校次"这种标签行毫无意义
- 正确做法是列名直接叫"语文_得分"、"语文_校次"

---

## 数据处理建议

### 标准化方案

**步骤1: 识别表头行数**
```python
if "得分" in row2:  # 判断第2行是否为标签行
    data_start_row = 2  # 跳过2行表头
else:
    data_start_row = 1  # 跳过1行表头
```

**步骤2: 统一列名**
```python
columns = [
    '考试', '姓名',
    '语文_得分', '语文_校次',
    '数学_得分', '数学_校次',
    '英语_得分', '英语_校次',
    '物理_得分', '物理_校次',
    '化学_得分', '化学_校次',
    '生物_得分', '生物_校次',
    '总分', '总校次'
]
```

**步骤3: 删除冗余列**
- 删除第1列（考试名称），用文件名标识

**步骤4: 数据验证**
- 检查学生名单是否一致
- 验证数据完整性（无缺失值）
- 校验校次范围（1-1400左右）

---

## 结论

这两个文件是**典型的"人工制表"产物**：

1. **没有统一规范**：不同人做的表，格式不同
2. **缺乏数据意识**：不考虑机器解析的需求
3. **信息冗余**：第1列、标签行都是多余的

如果要用程序处理，**必须先做格式标准化**，否则每个文件都要写不同的解析代码，完全无法维护。

建议采用"读取→标准化→统一存储"的三步处理流程。
