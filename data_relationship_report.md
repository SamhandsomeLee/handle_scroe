# Excel 文件数据关系分析报告

## 文件概览

### 1. 汇总文件：`22历次成绩.xls`
- **作用**：整合所有考试数据的主文件
- **工作表数量**：8个
- **工作表列表**：
  1. 历次成绩原始
  2. 历次成绩打印
  3. 尖子生成绩
  4. 高一期末
  5. **高二一调** ← 对应独立文件
  6. **高二期中** ← 对应独立文件
  7. 均值 姓名排序（统计表）
  8. 两次 均值 升序（统计表）

### 2. 独立文件：`22高二一调.xls`
- **作用**：高二一调考试的原始数据文件
- **工作表数量**：2个
  - 工作表1: **高二一调** (56行 × 16列)
  - 工作表2: **高二期中** (56行 × 16列)

### 3. 独立文件：`22高二期中.xls`
- **作用**：高二期中考试的原始数据文件
- **工作表数量**：2个
  - 工作表1: **高二一调** (56行 × 16列)
  - 工作表2: **高二期中** (56行 × 16列)

---

## 关键发现

### 🎯 核心结论

**独立文件的结构完全相同！**

两个所谓的"独立文件"实际上是**同一个文件的两个副本**，只是文件名不同：
- `22高二一调.xls` 和 `22高二期中.xls` 包含完全相同的内容
- 每个文件都包含两次考试的数据（高二一调 + 高二期中）

### ✅ 数据一致性验证

#### 验证1：高二一调数据
```
汇总文件[高二一调工作表] ≡ 独立文件[22高二一调.xls - 第1个工作表]
结果: ✅ 完全一致（56行 × 16列，0处差异）
```

#### 验证2：高二期中数据
```
汇总文件[高二期中工作表] ≡ 独立文件[22高二期中.xls - 第2个工作表]
结果: ✅ 完全一致（56行 × 16列，0处差异）
```

---

## 数据流向图

```
┌─────────────────────────────────────┐
│  原始数据源（推测）                  │
│  - 可能来自教务系统导出              │
│  - 或手工整理的Excel表格             │
└───────────────┬─────────────────────┘
                │
                ▼
┌─────────────────────────────────────┐
│  22高二一调.xls / 22高二期中.xls     │  ← 同一个文件
│  ┌───────────────────────────────┐  │
│  │ 工作表1: 高二一调              │  │
│  │ 工作表2: 高二期中              │  │
│  └───────────────────────────────┘  │
└───────────────┬─────────────────────┘
                │
                │ 数据提取/复制
                ▼
┌─────────────────────────────────────┐
│  22历次成绩.xls（汇总文件）          │
│  ┌───────────────────────────────┐  │
│  │ 工作表5: 高二一调 ← 复制       │  │
│  │ 工作表6: 高二期中 ← 复制       │  │
│  │ 工作表7: 均值姓名排序 ← 计算   │  │
│  │ 工作表8: 两次均值升序 ← 计算   │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
```

---

## 文件命名问题

### ⚠️ 严重的命名误导

**问题**：文件名与实际内容不符

| 文件名 | 实际内容 | 问题 |
|--------|---------|------|
| `22高二一调.xls` | 包含高二一调 **和** 高二期中两次考试 | 文件名只提到"一调" |
| `22高二期中.xls` | 包含高二一调 **和** 高二期中两次考试 | 文件名只提到"期中" |

**正确的命名应该是**：
- `22高二一调+期中.xls` 或
- `22高二两次考试.xls` 或
- 分成两个真正独立的文件，每个只包含一次考试

---

## 表头结构差异

### 高二一调（双层表头）
```
行1: [空] | 姓名 | 语文 | 校次 | 数学 | 校次 | ...
行2: [空] | [空] | 得分 | 校次 | 得分 | 校次 | ...
行3: 高二一调 | 柴艺萱 | 97.5 | 873 | 115 | 197 | ...  ← 数据开始
```

### 高二期中（单层表头）
```
行1: [空] | 姓名 | 语文 | [空] | 数学 | [空] | ...
行2: 高二期中 | 柴艺萱 | 111 | 402 | 135 | 563 | ...  ← 数据开始
```

**问题**：同一个文件中的两个工作表，表头格式不统一

---

## 数据处理建议

### 1. 文件组织问题
- **当前**：两个文件内容完全相同，造成数据冗余
- **建议**：删除其中一个，或者真正拆分成两个独立文件

### 2. 表头标准化
```python
# 建议的统一列名
columns = [
    '姓名',
    '语文_得分', '语文_校次',
    '数学_得分', '数学_校次',
    '英语_得分', '英语_校次',
    '物理_得分', '物理_校次',
    '化学_得分', '化学_校次',
    '生物_得分', '生物_校次',
    '总分', '总校次'
]
```

### 3. 数据读取逻辑
```python
def read_exam_data(file_path, sheet_index):
    """
    读取考试数据
    
    参数:
        file_path: Excel文件路径
        sheet_index: 0=高二一调, 1=高二期中
    """
    workbook = xlrd.open_workbook(file_path)
    sheet = workbook.sheet_by_index(sheet_index)
    
    # 判断表头结构
    if "得分" in str(sheet.cell(1, 2).value):
        data_start = 2  # 双层表头
    else:
        data_start = 1  # 单层表头
    
    # 读取数据...
```

### 4. 汇总文件的其他工作表
目前未知的工作表（可能来自其他独立文件）：
- 历次成绩原始
- 历次成绩打印
- 尖子生成绩
- 高一期末

**需要**：找到这些工作表对应的原始数据文件进行验证

---

## 总结

### 已验证的关系

| 汇总文件工作表 | 来源文件 | 来源工作表 | 一致性 |
|--------------|---------|-----------|--------|
| 高二一调 | 22高二一调.xls | 第1个工作表 | ✅ 100% |
| 高二期中 | 22高二期中.xls | 第2个工作表 | ✅ 100% |
| 均值姓名排序 | 计算生成 | - | 基于上述两次考试 |
| 两次均值升序 | 计算生成 | - | 基于上述两次考试 |

### 未验证的工作表
- 历次成绩原始
- 历次成绩打印
- 尖子生成绩
- 高一期末

### 关键问题
1. **文件冗余**：两个"独立文件"实际是同一个文件
2. **命名误导**：文件名与内容不符
3. **格式混乱**：表头结构不统一
4. **第1列冗余**：所有行重复写考试名称

### 建议
如果要开发成绩处理系统，**必须先进行数据清理和标准化**。
